# Admin & RBAC System Documentation

## üé≠ Role Hierarchy

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    SUPER ADMINISTRATOR                  ‚îÇ
‚îÇ                      (Level 100)                        ‚îÇ
‚îÇ  üëë Complete system control & all privileges            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      ADMINISTRATOR                       ‚îÇ
‚îÇ                       (Level 50)                        ‚îÇ
‚îÇ  ‚ö° User & loan management, reports, support            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      REGULAR USER                        ‚îÇ
‚îÇ                        (Level 0)                        ‚îÇ
‚îÇ  üë§ Loan applications & personal dashboard              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìã Database Tables

### Core RBAC Tables
1. **`roles`** - Defines user roles (super_admin, admin, user)
2. **`user_roles`** - Assigns roles to users (many-to-many)
3. **`permissions`** - Granular permission definitions
4. **`role_permissions`** - Maps permissions to roles
5. **`admin_activity_log`** - Tracks all admin actions

## üîë Permissions by Module

### üë• User Management
- `users.view_all` - View all user accounts
- `users.create` - Create new users
- `users.edit` - Edit user information
- `users.delete` - Delete/deactivate users
- `users.verify_kyc` - Approve/reject KYC documents

### üîê Admin Management (Super Admin Only)
- `admins.view_all` - View all admin accounts
- `admins.create` - Create admin accounts
- `admins.edit` - Edit admin accounts
- `admins.delete` - Delete admin accounts

### üé≠ Role Management (Super Admin Only)
- `roles.view` - View roles and permissions
- `roles.assign` - Assign roles to users
- `roles.create` - Create new roles
- `roles.delete` - Delete roles

### üí∞ Loan Management
- `loans.view_all` - View all loan applications
- `loans.approve` - Approve/reject loans
- `loans.modify` - Modify loan terms

### üìä Reports & Analytics
- `reports.view` - Access reports dashboard
- `reports.export` - Export reports

### ‚öôÔ∏è System Settings (Super Admin Only)
- `settings.view` - View system settings
- `settings.edit` - Modify configurations

### üìù Activity Logs
- `logs.view` - View activity logs
- `logs.export` - Export logs

## üîê Default Accounts

### Super Administrator
```
Email:    superadmin@efin.co.in
Password: SuperAdmin@2025
Permissions: ALL (22 permissions)
```

**Capabilities:**
- ‚úÖ Create/edit/delete admins
- ‚úÖ Manage all roles and permissions
- ‚úÖ Complete system configuration
- ‚úÖ All user and loan management
- ‚úÖ Full access to reports and logs
- ‚úÖ System settings control

### Administrator
```
```

**Capabilities:**
- ‚úÖ View/create/edit users
- ‚úÖ Verify KYC documents
- ‚úÖ Manage loan applications
- ‚úÖ View reports and activity logs
- ‚ùå Cannot create/edit other admins
- ‚ùå Cannot modify system settings
- ‚ùå Cannot create new roles

## üõ°Ô∏è Security Features

1. **Role-based Access Control** - Granular permission system
2. **Activity Logging** - All admin actions are tracked
3. **Password Hashing** - Bcrypt encryption for passwords
4. **Session Management** - Secure session tracking
5. **Failed Login Tracking** - Monitor suspicious activity

## üìù Usage Examples

### Check if user has permission:
```javascript
// In your backend code
function hasPermission(userId, permissionName) {
  // Query user_roles -> role_permissions -> permissions
  // Return true/false
}
```

### Assign role to user:
```javascript
// Only super admin can assign admin roles
assignRole(targetUserId, roleId, assignedByUserId);
```

### Log admin action:
```javascript
logAdminAction({
  admin_user_id: adminId,
  action_type: 'user_created',
  target_user_id: newUserId,
  description: 'Created new user account',
  ip_address: req.ip,
  metadata: { ... }
});
```

## ‚ö†Ô∏è Important Security Notes

1. **Change default passwords immediately** after first login
2. **Super Admin** should only be used for critical operations
3. All admin actions are **logged and auditable**
4. Role assignments require proper authorization
5. Implement **IP whitelisting** for admin accounts in production

## üöÄ Next Steps

1. Create authentication middleware to check permissions
2. Implement admin dashboard UI
3. Add 2FA for admin accounts
4. Set up email notifications for admin actions
5. Create audit report generation

---

**Created:** 2025-12-10
**Version:** 1.0
**System:** E-Fin Finance Platform
